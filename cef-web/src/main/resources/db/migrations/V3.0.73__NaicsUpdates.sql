
ALTER TABLE naics_code ADD COLUMN first_inventory_year integer;

update naics_code set last_inventory_year = '2021' where code = '212111';
update naics_code set last_inventory_year = '2021' where code = '212112';
update naics_code set last_inventory_year = '2021' where code = '212113';
update naics_code set last_inventory_year = '2021' where code = '212221';
update naics_code set last_inventory_year = '2021' where code = '212222';
update naics_code set last_inventory_year = '2021' where code = '212291';
update naics_code set last_inventory_year = '2021' where code = '212299';
update naics_code set last_inventory_year = '2021' where code = '212324';
update naics_code set last_inventory_year = '2021' where code = '212325';
update naics_code set last_inventory_year = '2021' where code = '212391';
update naics_code set last_inventory_year = '2021' where code = '212392';
update naics_code set last_inventory_year = '2021' where code = '212393';
update naics_code set last_inventory_year = '2021' where code = '212399';
update naics_code set last_inventory_year = '2021' where code = '315110';
update naics_code set last_inventory_year = '2021' where code = '315190';
update naics_code set last_inventory_year = '2021' where code = '315220';
update naics_code set last_inventory_year = '2021' where code = '315240';
update naics_code set last_inventory_year = '2021' where code = '315280';
update naics_code set last_inventory_year = '2021' where code = '316992';
update naics_code set last_inventory_year = '2021' where code = '316998';
update naics_code set last_inventory_year = '2021' where code = '321213';
update naics_code set last_inventory_year = '2021' where code = '321214';
update naics_code set last_inventory_year = '2021' where code = '322121';
update naics_code set last_inventory_year = '2021' where code = '322122';
update naics_code set last_inventory_year = '2021' where code = '333244';
update naics_code set last_inventory_year = '2021' where code = '333249';
update naics_code set last_inventory_year = '2021' where code = '333314';
update naics_code set last_inventory_year = '2021' where code = '333316';
update naics_code set last_inventory_year = '2021' where code = '333318';
update naics_code set last_inventory_year = '2021' where code = '333997';
update naics_code set last_inventory_year = '2021' where code = '333999';
update naics_code set last_inventory_year = '2021' where code = '334613';
update naics_code set last_inventory_year = '2021' where code = '334614';
update naics_code set last_inventory_year = '2021' where code = '335110';
update naics_code set last_inventory_year = '2021' where code = '335121';
update naics_code set last_inventory_year = '2021' where code = '335122';
update naics_code set last_inventory_year = '2021' where code = '335129';
update naics_code set last_inventory_year = '2021' where code = '335911';
update naics_code set last_inventory_year = '2021' where code = '335912';
update naics_code set last_inventory_year = '2021' where code = '336111';
update naics_code set last_inventory_year = '2021' where code = '336112';
update naics_code set last_inventory_year = '2021' where code = '337124';
update naics_code set last_inventory_year = '2021' where code = '337125';
update naics_code set last_inventory_year = '2021' where code = '424320';
update naics_code set last_inventory_year = '2021' where code = '424330';
update naics_code set last_inventory_year = '2021' where code = '425110';
update naics_code set last_inventory_year = '2021' where code = '441228';
update naics_code set last_inventory_year = '2021' where code = '441310';
update naics_code set last_inventory_year = '2021' where code = '441320';
update naics_code set last_inventory_year = '2021' where code = '442110';
update naics_code set last_inventory_year = '2021' where code = '442210';
update naics_code set last_inventory_year = '2021' where code = '442291';
update naics_code set last_inventory_year = '2021' where code = '442299';
update naics_code set last_inventory_year = '2021' where code = '443141';
update naics_code set last_inventory_year = '2021' where code = '443142';
update naics_code set last_inventory_year = '2021' where code = '444130';
update naics_code set last_inventory_year = '2021' where code = '444190';
update naics_code set last_inventory_year = '2021' where code = '444210';
update naics_code set last_inventory_year = '2021' where code = '444220';
update naics_code set last_inventory_year = '2021' where code = '445120';
update naics_code set last_inventory_year = '2021' where code = '445210';
update naics_code set last_inventory_year = '2021' where code = '445220';
update naics_code set last_inventory_year = '2021' where code = '445299';
update naics_code set last_inventory_year = '2021' where code = '445310';
update naics_code set last_inventory_year = '2021' where code = '446110';
update naics_code set last_inventory_year = '2021' where code = '446120';
update naics_code set last_inventory_year = '2021' where code = '446130';
update naics_code set last_inventory_year = '2021' where code = '446191';
update naics_code set last_inventory_year = '2021' where code = '446199';
update naics_code set last_inventory_year = '2021' where code = '447110';
update naics_code set last_inventory_year = '2021' where code = '447190';
update naics_code set last_inventory_year = '2021' where code = '448110';
update naics_code set last_inventory_year = '2021' where code = '448120';
update naics_code set last_inventory_year = '2021' where code = '448130';
update naics_code set last_inventory_year = '2021' where code = '448140';
update naics_code set last_inventory_year = '2021' where code = '448150';
update naics_code set last_inventory_year = '2021' where code = '448190';
update naics_code set last_inventory_year = '2021' where code = '448210';
update naics_code set last_inventory_year = '2021' where code = '448310';
update naics_code set last_inventory_year = '2021' where code = '448320';
update naics_code set last_inventory_year = '2021' where code = '451110';
update naics_code set last_inventory_year = '2021' where code = '451120';
update naics_code set last_inventory_year = '2021' where code = '451130';
update naics_code set last_inventory_year = '2021' where code = '451140';
update naics_code set last_inventory_year = '2021' where code = '451211';
update naics_code set last_inventory_year = '2021' where code = '451212';
update naics_code set last_inventory_year = '2021' where code = '452210';
update naics_code set last_inventory_year = '2021' where code = '452311';
update naics_code set last_inventory_year = '2021' where code = '452319';
update naics_code set last_inventory_year = '2021' where code = '453110';
update naics_code set last_inventory_year = '2021' where code = '453210';
update naics_code set last_inventory_year = '2021' where code = '453220';
update naics_code set last_inventory_year = '2021' where code = '453310';
update naics_code set last_inventory_year = '2021' where code = '453910';
update naics_code set last_inventory_year = '2021' where code = '453920';
update naics_code set last_inventory_year = '2021' where code = '453930';
update naics_code set last_inventory_year = '2021' where code = '453991';
update naics_code set last_inventory_year = '2021' where code = '453998';
update naics_code set last_inventory_year = '2021' where code = '454110';
update naics_code set last_inventory_year = '2021' where code = '454210';
update naics_code set last_inventory_year = '2021' where code = '454310';
update naics_code set last_inventory_year = '2021' where code = '454390';
update naics_code set last_inventory_year = '2021' where code = '511110';
update naics_code set last_inventory_year = '2021' where code = '511120';
update naics_code set last_inventory_year = '2021' where code = '511130';
update naics_code set last_inventory_year = '2021' where code = '511140';
update naics_code set last_inventory_year = '2021' where code = '511191';
update naics_code set last_inventory_year = '2021' where code = '511199';
update naics_code set last_inventory_year = '2021' where code = '511210';
update naics_code set last_inventory_year = '2021' where code = '515111';
update naics_code set last_inventory_year = '2021' where code = '515112';
update naics_code set last_inventory_year = '2021' where code = '515120';
update naics_code set last_inventory_year = '2021' where code = '515210';
update naics_code set last_inventory_year = '2021' where code = '517311';
update naics_code set last_inventory_year = '2021' where code = '517312';
update naics_code set last_inventory_year = '2021' where code = '517911';
update naics_code set last_inventory_year = '2021' where code = '517919';
update naics_code set last_inventory_year = '2021' where code = '519110';
update naics_code set last_inventory_year = '2021' where code = '519120';
update naics_code set last_inventory_year = '2021' where code = '519130';
update naics_code set last_inventory_year = '2021' where code = '519190';
update naics_code set last_inventory_year = '2021' where code = '522120';
update naics_code set last_inventory_year = '2021' where code = '522190';
update naics_code set last_inventory_year = '2021' where code = '522293';
update naics_code set last_inventory_year = '2021' where code = '522294';
update naics_code set last_inventory_year = '2021' where code = '522298';
update naics_code set last_inventory_year = '2021' where code = '523110';
update naics_code set last_inventory_year = '2021' where code = '523120';
update naics_code set last_inventory_year = '2021' where code = '523130';
update naics_code set last_inventory_year = '2021' where code = '523140';
update naics_code set last_inventory_year = '2021' where code = '523920';
update naics_code set last_inventory_year = '2021' where code = '523930';
update naics_code set last_inventory_year = '2021' where code = '811112';
update naics_code set last_inventory_year = '2021' where code = '811113';
update naics_code set last_inventory_year = '2021' where code = '811118';
update naics_code set last_inventory_year = '2021' where code = '811211';
update naics_code set last_inventory_year = '2021' where code = '811212';
update naics_code set last_inventory_year = '2021' where code = '811213';
update naics_code set last_inventory_year = '2021' where code = '811219';


update naics_code set description = 'Wet Corn Milling and Starch Manufacturing' where code = '311221';
update naics_code set description = 'Photographic Film, Paper, Plate, Chemical, and Copy Toner Manufacturing' where code = '325992';
update naics_code set description = 'Tobacco Product and Electronic Cigarette Merchant Wholesalers' where code = '424940';
update naics_code set description = 'Paint and Wallpaper Retailers' where code = '444120';
update naics_code set description = 'Supermarkets and Other Grocery Retailers (except Convenience Retailers)' where code = '445110';
update naics_code set description = 'Fruit and Vegetable Retailers' where code = '445230';
update naics_code set description = 'Baked Goods Retailers' where code = '445291';
update naics_code set description = 'Confectionery and Nut Retailers' where code = '445292';
update naics_code set description = 'Taxi and Ridesharing Services' where code = '485310';
update naics_code set description = 'Computing Infrastructure Providers, Data Processing, Web Hosting, and Related Services' where code = '518210';
update naics_code set description = 'Pharmacy Benefit Management and Other Third Party Administration of Insurance and Pension Funds' where code = '524292';
update naics_code set description = 'Testing Laboratories and Services' where code = '541380';
update naics_code set description = 'Indoor and Outdoor Display Advertising' where code = '541850';
update naics_code set description = 'Investigation and Personal Background Check Services' where code = '561611';
update naics_code set description = 'Child Care Services' where code = '624410';


insert into naics_code (code,description,first_inventory_year) values (212114,'Surface Coal Mining','2022');
insert into naics_code (code,description,first_inventory_year) values (212115,'Underground Coal Mining','2022');
insert into naics_code (code,description,first_inventory_year) values (212220,'Gold Ore and Silver Ore Mining','2022');
insert into naics_code (code,description,first_inventory_year) values (212290,'Other Metal Ore Mining','2022');
insert into naics_code (code,description,first_inventory_year) values (212323,'Kaolin, Clay, and Ceramic and Refractory Minerals Mining','2022');
insert into naics_code (code,description,first_inventory_year) values (212390,'Other Nonmetallic Mineral Mining and Quarrying','2022');
insert into naics_code (code,description,first_inventory_year) values (315120,'Apparel Knitting Mills','2022');
insert into naics_code (code,description,first_inventory_year) values (315250,'Cut and Sew Apparel Manufacturing (except Contractors)','2022');
insert into naics_code (code,description,first_inventory_year) values (316990,'Other Leather and Allied Product Manufacturing','2022');
insert into naics_code (code,description,first_inventory_year) values (321215,'Engineered Wood Member Manufacturing','2022');
insert into naics_code (code,description,first_inventory_year) values (322120,'Paper Mills','2022');
insert into naics_code (code,description,first_inventory_year) values (325315,'Compost Manufacturing','2022');
insert into naics_code (code,description,first_inventory_year) values (333248,'All Other Industrial Machinery Manufacturing','2022');
insert into naics_code (code,description,first_inventory_year) values (333310,'Commercial and Service Industry Machinery Manufacturing','2022');
insert into naics_code (code,description,first_inventory_year) values (333998,'All Other Miscellaneous General Purpose Machinery Manufacturing','2022');
insert into naics_code (code,description,first_inventory_year) values (334610,'Manufacturing and Reproducing Magnetic and Optical Media','2022');
insert into naics_code (code,description,first_inventory_year) values (335131,'Residential Electric Lighting Fixture Manufacturing','2022');
insert into naics_code (code,description,first_inventory_year) values (335132,'Commercial, Industrial, and Institutional Electric Lighting Fixture Manufacturing','2022');
insert into naics_code (code,description,first_inventory_year) values (335139,'Electric Lamp Bulb and Other Lighting Equipment Manufacturing','2022');
insert into naics_code (code,description,first_inventory_year) values (335910,'Battery Manufacturing','2022');
insert into naics_code (code,description,first_inventory_year) values (336110,'Automobile and Light Duty Motor Vehicle Manufacturing','2022');
insert into naics_code (code,description,first_inventory_year) values (337126,'Household Furniture (except Wood and Upholstered) Manufacturing','2022');
insert into naics_code (code,description,first_inventory_year) values (424350,'Clothing and Clothing Accessories Merchant Wholesalers','2022');
insert into naics_code (code,description,first_inventory_year) values (441227,'Motorcycle, ATV, and All Other Motor Vehicle Dealers','2022');
insert into naics_code (code,description,first_inventory_year) values (441330,'Automotive Parts and Accessories Retailers','2022');
insert into naics_code (code,description,first_inventory_year) values (441340,'Tire Dealers','2022');
insert into naics_code (code,description,first_inventory_year) values (444140,'Hardware Retailers','2022');
insert into naics_code (code,description,first_inventory_year) values (444180,'Other Building Material Dealers','2022');
insert into naics_code (code,description,first_inventory_year) values (444230,'Outdoor Power Equipment Retailers','2022');
insert into naics_code (code,description,first_inventory_year) values (444240,'Nursery, Garden Center, and Farm Supply Retailers','2022');
insert into naics_code (code,description,first_inventory_year) values (445131,'Convenience Retailers','2022');
insert into naics_code (code,description,first_inventory_year) values (445132,'Vending Machine Operators','2022');
insert into naics_code (code,description,first_inventory_year) values (445240,'Meat Retailers','2022');
insert into naics_code (code,description,first_inventory_year) values (445250,'Fish and Seafood Retailers','2022');
insert into naics_code (code,description,first_inventory_year) values (445298,'All Other Specialty Food Retailers','2022');
insert into naics_code (code,description,first_inventory_year) values (445320,'Beer, Wine, and Liquor Retailers','2022');
insert into naics_code (code,description,first_inventory_year) values (449110,'Furniture Retailers','2022');
insert into naics_code (code,description,first_inventory_year) values (449121,'Floor Covering Retailers','2022');
insert into naics_code (code,description,first_inventory_year) values (449122,'Window Treatment Retailers','2022');
insert into naics_code (code,description,first_inventory_year) values (449129,'All Other Home Furnishings Retailers','2022');
insert into naics_code (code,description,first_inventory_year) values (449210,'Electronics and Appliance Retailers','2022');
insert into naics_code (code,description,first_inventory_year) values (455110,'Department Stores','2022');
insert into naics_code (code,description,first_inventory_year) values (455211,'Warehouse Clubs and Supercenters','2022');
insert into naics_code (code,description,first_inventory_year) values (455219,'All Other General Merchandise Retailers','2022');
insert into naics_code (code,description,first_inventory_year) values (456110,'Pharmacies and Drug Retailers','2022');
insert into naics_code (code,description,first_inventory_year) values (456120,'Cosmetics, Beauty Supplies, and Perfume Retailers','2022');
insert into naics_code (code,description,first_inventory_year) values (456130,'Optical Goods Retailers','2022');
insert into naics_code (code,description,first_inventory_year) values (456191,'Food (Health) Supplement Retailers','2022');
insert into naics_code (code,description,first_inventory_year) values (456199,'All Other Health and Personal Care Retailers','2022');
insert into naics_code (code,description,first_inventory_year) values (457110,'Gasoline Stations with Convenience Stores','2022');
insert into naics_code (code,description,first_inventory_year) values (457120,'Other Gasoline Stations','2022');
insert into naics_code (code,description,first_inventory_year) values (457210,'Fuel Dealers','2022');
insert into naics_code (code,description,first_inventory_year) values (458110,'Clothing and Clothing Accessories Retailers','2022');
insert into naics_code (code,description,first_inventory_year) values (458210,'Shoe Retailers','2022');
insert into naics_code (code,description,first_inventory_year) values (458310,'Jewelry Retailers','2022');
insert into naics_code (code,description,first_inventory_year) values (458320,'Luggage and Leather Goods Retailers','2022');
insert into naics_code (code,description,first_inventory_year) values (459110,'Sporting Goods Retailers','2022');
insert into naics_code (code,description,first_inventory_year) values (459120,'Hobby, Toy, and Game Retailers','2022');
insert into naics_code (code,description,first_inventory_year) values (459130,'Sewing, Needlework, and Piece Goods Retailers','2022');
insert into naics_code (code,description,first_inventory_year) values (459140,'Musical Instrument and Supplies Retailers','2022');
insert into naics_code (code,description,first_inventory_year) values (459210,'Book Retailers and News Dealers','2022');
insert into naics_code (code,description,first_inventory_year) values (459310,'Florists','2022');
insert into naics_code (code,description,first_inventory_year) values (459410,'Office Supplies and Stationery Retailers','2022');
insert into naics_code (code,description,first_inventory_year) values (459420,'Gift, Novelty, and Souvenir Retailers','2022');
insert into naics_code (code,description,first_inventory_year) values (459510,'Used Merchandise Retailers','2022');
insert into naics_code (code,description,first_inventory_year) values (459910,'Pet and Pet Supplies Retailers','2022');
insert into naics_code (code,description,first_inventory_year) values (459920,'Art Dealers','2022');
insert into naics_code (code,description,first_inventory_year) values (459930,'Manufactured (Mobile) Home Dealers','2022');
insert into naics_code (code,description,first_inventory_year) values (459991,'Tobacco, Electronic Cigarette, and Other Smoking Supplies Retailers','2022');
insert into naics_code (code,description,first_inventory_year) values (459999,'All Other Miscellaneous Retailers','2022');
insert into naics_code (code,description,first_inventory_year) values (513110,'Newspaper Publishers','2022');
insert into naics_code (code,description,first_inventory_year) values (513120,'Periodical Publishers','2022');
insert into naics_code (code,description,first_inventory_year) values (513130,'Book Publishers','2022');
insert into naics_code (code,description,first_inventory_year) values (513140,'Directory and Mailing List Publishers','2022');
insert into naics_code (code,description,first_inventory_year) values (513191,'Greeting Card Publishers','2022');
insert into naics_code (code,description,first_inventory_year) values (513199,'All Other Publishers','2022');
insert into naics_code (code,description,first_inventory_year) values (513210,'Software Publishers','2022');
insert into naics_code (code,description,first_inventory_year) values (516110,'Radio Broadcasting Stations','2022');
insert into naics_code (code,description,first_inventory_year) values (516120,'Television Broadcasting Stations','2022');
insert into naics_code (code,description,first_inventory_year) values (516210,'Media Streaming Distribution Services, Social Networks, and Other Media Networks and Content Providers','2022');
insert into naics_code (code,description,first_inventory_year) values (517111,'Wired Telecommunications Carriers','2022');
insert into naics_code (code,description,first_inventory_year) values (517112,'Wireless Telecommunications Carriers (except Satellite)','2022');
insert into naics_code (code,description,first_inventory_year) values (517121,'Telecommunications Resellers','2022');
insert into naics_code (code,description,first_inventory_year) values (517122,'Agents for Wireless Telecommunications Services','2022');
insert into naics_code (code,description,first_inventory_year) values (517810,'All Other Telecommunications','2022');
insert into naics_code (code,description,first_inventory_year) values (519210,'Libraries and Archives','2022');
insert into naics_code (code,description,first_inventory_year) values (519290,'Web Search Portals and All Other Information Services','2022');
insert into naics_code (code,description,first_inventory_year) values (522180,'Savings Institutions and Other Depository Credit Intermediation','2022');
insert into naics_code (code,description,first_inventory_year) values (522299,'International, Secondary Market, and All Other Nondepository Credit Intermediation','2022');
insert into naics_code (code,description,first_inventory_year) values (523150,'Investment Banking and Securities Intermediation','2022');
insert into naics_code (code,description,first_inventory_year) values (523160,'Commodity Contracts Intermediation','2022');
insert into naics_code (code,description,first_inventory_year) values (523940,'Portfolio Management and Investment Advice','2022');
insert into naics_code (code,description,first_inventory_year) values (811114,'Specialized Automotive Repair','2022');
insert into naics_code (code,description,first_inventory_year) values (811210,'Electronic and Precision Equipment Repair and Maintenance','2022');

--unrelated NAICS code fixes
update naics_code set description = 'Crude Petroleum Extraction' where code = '211120';
update naics_code set description = 'New Single-Family Housing Construction (except For-Sale Builders)' where code = '236115';
update naics_code set description = 'New Multifamily Housing Construction (except For-Sale Builders)' where code = '236116';
update naics_code set description = 'New Housing For-Sale Builders' where code = '236117';
update naics_code set description = 'Small Arms, Ordnance, and Ordnance Accessories Manufacturing' where code = '332994';

UPDATE naics_code SET non_point_bucket = '11' WHERE code >= 110000 AND code < 120000;
UPDATE naics_code SET non_point_bucket = '21' WHERE code >= 210000 AND code < 220000;
UPDATE naics_code SET non_point_bucket = '2212' WHERE code >= 221200 AND code < 221300;
UPDATE naics_code SET non_point_bucket = '2213' WHERE code >= 221300 AND code < 221400;
UPDATE naics_code SET non_point_bucket = '23' WHERE code >= 230000 AND code < 240000;
UPDATE naics_code SET non_point_bucket = '31' WHERE code >= 310000 AND code < 320000;
UPDATE naics_code SET non_point_bucket = '32' WHERE code >= 320000 AND code < 330000;
UPDATE naics_code SET non_point_bucket = '33' WHERE code >= 330000 AND code < 340000;
UPDATE naics_code SET non_point_bucket = '42' WHERE code >= 420000 AND code < 430000;
UPDATE naics_code SET non_point_bucket = '44' WHERE code >= 440000 AND code < 450000;
UPDATE naics_code SET non_point_bucket = '45' WHERE code >= 450000 AND code < 460000;
UPDATE naics_code SET non_point_bucket = '48 (except 4892)' WHERE code >= 480000 AND code < 486200;
UPDATE naics_code SET non_point_bucket = '48 (except 4892)' WHERE code >= 486300 AND code < 490000;
UPDATE naics_code SET non_point_bucket = '49' WHERE code >= 490000 AND code < 500000;
UPDATE naics_code SET non_point_bucket = '51' WHERE code >= 510000 AND code < 520000;
UPDATE naics_code SET non_point_bucket = '52' WHERE code >= 520000 AND code < 530000;
UPDATE naics_code SET non_point_bucket = '53' WHERE code >= 530000 AND code < 540000;
UPDATE naics_code SET non_point_bucket = '54' WHERE code >= 540000 AND code < 550000;
UPDATE naics_code SET non_point_bucket = '55' WHERE code >= 550000 AND code < 560000;
UPDATE naics_code SET non_point_bucket = '56' WHERE code >= 560000 AND code < 570000;
UPDATE naics_code SET non_point_bucket = '61' WHERE code >= 610000 AND code < 620000;
UPDATE naics_code SET non_point_bucket = '62' WHERE code >= 620000 AND code < 630000;
UPDATE naics_code SET non_point_bucket = '71' WHERE code >= 710000 AND code < 720000;
UPDATE naics_code SET non_point_bucket = '72' WHERE code >= 720000 AND code < 730000;
UPDATE naics_code SET non_point_bucket = '81' WHERE code >= 810000 AND code < 820000;
UPDATE naics_code SET non_point_bucket = '92' WHERE code >= 920000 AND code < 930000;

